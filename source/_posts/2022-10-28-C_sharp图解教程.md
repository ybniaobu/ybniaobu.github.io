---
title: 《C#图解教程》读书笔记（一）
date: 2022-10-28 09:42:57
categories: 
  - [C#, C#读书笔记]
tags:
  - .net
  - C#
  - 读书笔记
cover: https://s2.loli.net/2022/10/28/YztgSrJ6BTOWRLU.jpg
---

> 该笔记为 **《C#图解教程》** 的读书笔记，未经过系统的整理；  
> 学习完成日期为XXXX年XX月XX日。  
> 本篇主要内容为：XXXXXXXXXXXXXXXXXXXXXXX

<div  align="center">  
<img src="https://s2.loli.net/2022/10/31/VLR94de6aqA3WPw.jpg" width = "80%" height = "80%" alt="C#图解教程"/>
</div>

# 第一章 C#和.NET框架
## .NET框架的组成
.NET框架（.NET Framework）由三个部分组成：

<div  align="center">  
<img src="https://s2.loli.net/2022/10/31/sjP4eQIFqxNv65C.png" width = "30%" height = "30%" alt=".NET框架的组成"/>
</div>

执行环境称为**CLR**（Common Language Runtime 公共语言运行库）；CLR管理程序的执行，包括内存管理和垃圾收集（GC garbage collector 垃圾收集器）；代码安全验证；代码执行、线程管理及异常处理。

严格来说，.NET框架由**CLR**和**FCL**（Framework Class Library 框架类库）组成，FCL是BCL的超集。

**BCL**（Base Class Library 基类库）是.NET框架使用的一个大的类库。包括通用基础类：比如文件操作、字符串操作、安全和加密；集合类：实现了列表、字典、散列表（hash tables）以及位数组（bit arrays）；线程和同步类：用于创建多线程程序；XML类：用于创建、读取及操作XML文档。

> 以下内容摘《C#播放器指南》一书。  
> 
> BCL包含所有的内置类型、数组、异常、数学库、基本文件I/O、安全性、集合、反射、联网、字符串操作、线程等等。一般规则是任何以System开头的名称空间都是BCL的一部分。
> 
> 除了BCL之外，微软还随.NET框架提供了更多的类。通常，这些附加内容涵盖了广泛的功能领域，例如数据库访问或图形用户界面(Windows窗体或WPF)。包括BCL在内的整个集合被称为框架类库FCL。

## 编译为CIL
.NET语言的解释器接受源代码文件，并生成名为**程序集Assembly**的输出文件：

<div  align="center">  
<img src="https://s2.loli.net/2022/10/31/Q9dpN3izqSuKmGD.png" width = "45%" height = "45%" alt="编译过程"/>
</div>

**程序集**中的代码不是本机代码，而是**CIL**（Common Intermediate Language 公共中间语言）

程序集的信息中包括：程序的CIL；程序中使用的类型的元数据（Metadata）；对其他程序集引用的元数据。

## 编译成本机代码（Native Code）并执行
程序的CIL直到被调用运行时才会被编译成本机代码。在运行时，CLR执行以下步骤：  
（1）检查程序集的安全特性；  
（2）在内存中分配空间；  
（3）把程序集中的可执行代码发给即时编译器（just-in-time JIT compiler），把其中一部分编译成本机代码。

<div  align="center">  
<img src="https://s2.loli.net/2022/10/31/AtdGz26FTm4voMn.png" width = "40%" height = "40%" alt="运行时被编译成本机代码"/>
</div>

程序集中的可执行代码只有在被需要时由JIT编译器编译，然后就被缓存cache起来以备在后来的程序中执行。这意味着不被调用的代码不会被编译成本机代码，而且被调用到的代码只被编译一次。

一旦CIL被编译成本机代码，CLR就在运行时管理它，执行如释放无主内存、检查参数类型、管理异常等任务。在CLR控制之下的代码称为托管代码（managed code）；而不在CLR控制之下运行的代码为非托管代码。

## CLR
.NET框架的核心组件是**CLR**，它在操作系统顶层，负责管理程序的执行：

<div  align="center">  
<img src="https://s2.loli.net/2022/11/01/iltGr4vmNuyMsA1.png" width = "50%" height = "50%" alt="CLR概览"/>
</div>

CLR还通过访问BCL得到广泛的编程功能，包括如Web服务和数据服务之类的功能。

## CLI
每种编程语言都有一组内置的类型，包括整数、浮点数和字符等对象。但是这些类型因为编程语言和平台的不同而不同，这种缺乏统一性需要一组标准促进有序协作。

**CLI**（Common Language Infrastructure 公共语言基础结构）就是一组标准，它把.NET框架的所有组件连结成了一个系统。

<div  align="center">  
<img src="https://s2.loli.net/2022/11/01/Qq9xHIoUvszDgZh.png" width = "55%" height = "55%" alt="CLI组成"/>
</div>

1. 公共类型系统  
**CTS**（Common Type System 公共类型系统），它定义了一组内置类型；.NET兼容编程语言提供的类型通常映射到CTS已定义的内置类型集的某个特殊子集；***CTS让所有类型都继承自公共的基类——object***；CTS确保用户定义的类型和系统类型能够被任何.NET兼容的语言使用。

2. 公共语言规范  
**CLS**（Common Language Specification 公共语言规范）详细说明了.NET兼容编程语言的规则、属性和行为，包括数据类型、类结构和参数传递）。


# 第二章 C#和.NET Core
## .NET Core的由来
为了更好地解决Web开发以及Linux或macOS的开发，微软用.NET框架搭建了一个基于云的、跨平台的、开源衍生产品，这个新框架即 **.NET Core**。微软也收购了Xamarin以解决Android和IOS等移动平台的开发问题。

<div  align="center">  
<img src="https://s2.loli.net/2022/11/01/UBiFr2XZNK4nJuE.png" width = "70%" height = "70%" alt=".NET生态系统"/>
</div>

.NET Core主要目标为多平台支持；快速开发和升级；更小的应用程序占用空间；更简单的部署；更少的版本问题；开源社区的支持；改进的应用程序性能。


# 第三章 C#编程概述
