---
title: MIT 线性代数公开课笔记（二）
date: 2024-02-18 13:52:33
categories: 
  - [数学, 3d数学基础]
  - [数学, 线性代数]
tags:
  - 游戏开发
  - 数学
  - 线性代数
top_img: /images/black.jpg
cover: https://s2.loli.net/2024/02/18/6rKVn5pm3sXlxS8.gif
mathjax: true
---

> 该笔记主要内容为XXXXXXXXXXXXX；
> 该笔记主要参考了 MLNLP 的关于该公开课的 GitHub 公开项目的笔记：<https://github.com/MLNLP-World/MIT-Linear-Algebra-Notes>  
> 公开课 B 站 bv 号：BV16Z4y1U7oU


# 第十四课 正交向量与正交子空间

<div  align="center">  
<img src="https://s2.loli.net/2024/02/18/iwvTI9XHNrf4QjB.png" width = "60%" height = "60%" alt="图4 - 四个子空间的关系"/>
</div>

## 向量正交
**正交 Orthogonal **就是**垂直 perpendicular** 的另一种说法。两向量正交的判据之一是其点积 $\,x^Ty = y^Tx = 0\,$。

可以根据勾股定理（毕达哥拉斯定理 Pythagorean theorem）推出上述判断，当两个向量的夹角为 90 度时，x，y 满足：  

$$ |x|^2 + |y|^2 = |x + y|^2 $$

其中 $\,|x|^2 = x^Tx\,$（x 为 列向量），可得：

$$ x^Tx + y^Ty = (x + y)^T(x + y) = x^Tx + y^Ty + x^Ty + y^Tx$$

可得 $\,x^Ty + y^Tx = 0\,$，因 $\,x^Ty\,$ 与 $\,y^Tx\,$ 其实是一样的，都表示两个一维向量的点乘，故若两个向量正交，则 $\,x^Ty = y^Tx = 0\,$。

> 零向量与所有向量都正交。

## 子空间正交
**两个子空间正交**就是：**一个子空间中的任意一个向量，都与另一个子空间中的任意一个向量正交。**

在三维空间中，假设世界原点为黑板和地板交接处的一点，黑板所在的平面（子空间）和地板所在平面（子空间）不是正交关系，沿两者的交线方向的向量同时属于两个平面，但并不与自己正交。即两个平面在某一非零向量处相交，那这两个平面一定不正交，因为相交处的这个非零向量无法满足空间正交定义。

再从子空间角度看一看正交空间，以 $\,R^2\,$ 的子空间为例，一个平面上的子空间有三种：  
①整个平面 D；  
②过原点的直线 L；  
③原点 O。

看一看这些子空间之间的正交，以 L 为例：  
①L 与 D 什么时候正交？  
一个平面上的直线不可能与这个平面垂直；  
②L 什么时候与 O 正交？  
L 与 O 永远是正交的；  
③L 什么时候与另一个 L 正交？  
由正交的定义，两条直线在原点处互相垂直，这两个 L 空间才正交。

## 零空间与行空间的正交关系 
零空间与行空间之间是正交的，得到这个结论并不难，我们把 A 写成行向量形式，再看 Ax = 0 这个方程：  

$$ \begin{bmatrix} R_1 \\ R_2 \\ ... \\ ... \\ R_m \end{bmatrix} \begin{bmatrix} x_1 \\ x_2 \\ ... \\ ... \end{bmatrix} = \begin{bmatrix} R_1(x_1, x_2, ...) \\ R_2(x_1, x_2, ...) \\ ... \\ ... \\ R_m(x_1, x_2, ...) \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \\ ... \\ ... \\ 0 \end{bmatrix} $$

x 与矩阵 A 的行向量点积都等于 0，则它和矩阵 A 行向量的线性组合进行点积也为 0，所以 x 与 A 的行空间正交。x 为零空间内的任意向量，所以零空间与行空间正交。同理可以证明列空间与左零空间正交。

---

行空间和零空间类似于把 $\,R^n\,$ 空间分割成了两个正交的子空间。例如对于矩阵：$\,A = \begin{bmatrix} 1 & 2 & 5 \\ 2 & 4 & 10 \end{bmatrix}\,$，其行空间是 1 维的，向量 (1, 2, 5) 是它的基向量，而其零空间是垂直于 (1, 2, 5) 并穿过原点的二维平面。行空间和零空间不仅仅是正交，并且其维数之和等于 n，我们称行空间和零空间为 $\,R^n\,$ 空间内的**正交补 orthogonal complements**。这表示零空间包含所有和行空间正交的向量，反之亦然。

> 想想我们之前提到的黑板和地板平面不是正交子空间的例子，二者都在三维空间中，分别为二维空间，因此不可能正交。一个空间中正交子空间的维数之和不可能超过原空间的维数。

## 无解方程的最优解
下面讨论如何求解一个无解方程组 Ax = b 的解（引出下一节的内容）。矩阵的数据来源于实际测量，那么就势必会有测量不准确的时候，如果 A 是长方形矩阵，m 大于 n。当左侧方程数特别多的时候，容易混入“坏”数据，方程变得无解。但是对于数据的可信度我们无从判断，线性代数要做的就是在这种条件下求一个方程的“最优解”。矩阵 $\,A^TA\,$ 会发挥重要作用，它是一个 n x n 方阵，并且是对称矩阵。

将方程改写成：$\,A^TA \hat {x} = A^Tb\,$，即求解 $\,\hat {x}\,$ 这个最优解。我们利用了 $\,A^TA\,$ 矩阵的特殊性质如下：  
①设 A 为 m × n 矩阵，则 $\,A^TA\,$ 为 n × n 矩阵；  
②$\,A^TA\,$，总为对称矩阵。$\,(A^TA)^T = A^TA\,$，故 $\,A^TA\,$ 总是对称的。

有一点需要注意，$\,A^TA\,$ 矩阵不一定总是可逆的，所以在求解时要注意 A 的特点。很明显，当 A 矩阵列向量线性相关时候，$\,A^TA\,$ 就不可逆了。因此若要 $\,A^TA\,$ 矩阵可逆，则要求 A 的零空间只有零向量，即 A 的列向量线性无关。


# 第十五课 子空间投影
这节主要讲**投影 projection**，从向量的投影入手，延伸到高维投影，并将投影用矩阵形式给出。做投影即是向另一个向量上做垂线，跟上节课的正交有联系。

## 向量投影

<div  align="center">  
<img src="https://s2.loli.net/2024/02/19/xU4EQOj73XNgM2F.jpg" width = "50%" height = "50%" alt="图5 - 向量投影"/>
</div>

投影问题的几何解释就是：如何在向量 a 的方向上寻找与向量 b 距离最近的一点。从图中可以看出，这个距离最近的点 p 就位于穿过 b 点并与向量 a 正交的直线与向量 a 所在直线的交点，即 b 在 a 上的投影。

> 如果我们将向量 p 视为 b 的一种近似，则长度 e = b - p 就是这一近似的误差。

因为 p 在向量 a 的方向上，因此可以令 p = xa，而因为它和 e 正交，我们可以得到方程：  

$$ a^Te = a^T(b - p) = a^T(b - xa) = 0 $$

可得：  

$$ x = \frac {a^Tb} {a^Ta}, p = xa = a \frac {a^Tb} {a^Ta} $$

如果 b 变为原来的 2 倍，则 p 也变为原来的 2 倍。而如果 a 变为原来的 2 倍，p 不发生变化。从几何上和计算中都会得到验证。

## 投影矩阵
接下来我们将投影问题用投影矩阵的方式进行描述，即 $\,p = Pb\,$，其中 $\,P\,$ 为投影矩阵。

根据 $\,p = xa = a \frac {a^Tb} {a^Ta}\,$，可知 $\,P = \frac {aa^T} {a^Ta}\,$，注意当 a 是列向量时，分母 $\,a^Ta\,$ 是一个数，分子 $\,aa^T\,$ 是一个矩阵。

观察这个矩阵可知，因为 a 是列向量，$\,aa^T\,$ 得到的必然是秩一矩阵，矩阵 P 的列空间就是向量 a 所在的直线，矩阵 P 的秩为 1。同样，投影矩阵 P 是一个对称矩阵，即 $\,P^T = P\,$；另一方面，如果投影两次，第二次投影还在原来的位置，即 $\,P^2 = P\,$。

## Why Project
如上一节结尾所述，方程 Ax = b 有可能无解，我们需要得到方程的“最优解”。这里的问题在于向量 Ax 一定在矩阵 A 的列空间之内，但是 b 不一定，因此我们希望将 b 投影到 A 的列空间得到 p，将问题转化为 $\,A\hat {x} = p\,$。

## 平面投影

<div  align="center">  
<img src="https://s2.loli.net/2024/02/19/7uG81TXxNLzUKnQ.jpg" width = "50%" height = "50%" alt="图6 - 平面投影"/>
</div>

$\,a_1\,$，$\,a_2\,$ 构成平面的一组基，平面是矩阵 $\,A = \begin{bmatrix} a_1 & a_2\end{bmatrix}\,$ 的列空间。

p 在平面上，即 $\,p = \hat {x_1} a_1 + \hat {x_2} a_2\,$，即 $\,p = A\hat {x}\,$。

而 $\,e = b - p = b - A \hat {x}\,$ 与投影平面正交，也就是 $\,e\,$ 与 $\,a_1\,$ 和 $\,a_2\,$ 均正交，可得 $\,a_1^T(b - A \hat {x}) = 0\,$ 和 $\,a_2^T(b - A \hat {x}) = 0\,$。

因为 $\,a_1\,$ 和 $\,a_2\,$ 分别为矩阵 A 的列向量，即 $\,a_1^T\,$ 和 $\,a_2^T\,$ 为矩阵 $\,A^T\,$ 的行向量，所以将两个方程式写成矩阵形式即为 $\,A^T(b - A \hat {x}) = 0\,$，这与一维投影的方程形式相同，一维投影只是 A 只有一列的情况下。

$\,A^T(b - A \hat {x}) = 0\,$ 这个公式说明了，向量 $\,e = b - A \hat {x}\,$ 存在于矩阵 $\,A^T\,$ 的零空间 $\,N(A^T)\,$ ，即 e 向量与 $\,A^T\,$ 的行向量正交，也就与 A 的列向量正交。

--- 

将方程 $\,A^T(b - A \hat {x}) = 0\,$ 改写，可得 $\,A^TA \hat {x} = A^Tb\,$，也就是上一节结尾的公式。

我们要注意一点：不能直接在两边左乘 $\,(A^T)^{-1}\,$。因为 $\,A^T\,$ 不一定是方阵，不一定有逆矩阵。但是这里 A 为两个基向量构成的矩阵，两个基向量线性无关，根据上节的知识，$\,A^TA\,$是可逆的。在两侧同时左乘 $\,(A^TA)^{-1}\,$：

$$ \hat x = (A^TA)^{-1} A^T b $$

代入 $p = A \hat {x}$：  

$$ p = A \hat x = A(A^TA)^{-1} A^T b $$

即投影矩阵为：  

$$ P =  A(A^TA)^{-1} A^T $$

可以看出，之前一维的 $\,P = \frac {aa^T} {a^Ta}\,$ 是上式的特殊情况。

因为矩阵 A 不是方阵，无法简单地用 $\,(A^TA)^{-1} = A^{-1}(A^T)^{-1}\,$ 对投影矩阵进行化简。若 A 是可逆方阵，则化简得到 P = I。此时 A 的列空间就是整个 $\,R^n\,$ 空间，b 到这个空间的投影就是其本身，投影矩阵等于单位阵。

对 $\,P =  A(A^TA)^{-1} A^T\,$ 用矩阵乘法的结合律和矩阵乘积的转置公式，可以证明投影矩阵的性质：$\,P^T = P\,$，$\,P^2 = P\,$。

## 最小二乘法 Least Squares 初涉
应用投影矩阵求方程组最优解的方法，最常用于“最小二乘法”拟合曲线。

例如：求解三个点（1，1），（2,2），（3，2）拟合的直线方程

我们假设最优直线方程：b = C + Dt，代入三个点列出方程。

$$ C + D = 1 $$
$$ C + 2D = 2 $$
$$ C + 3D = 2 $$

矩阵形式为：

$$ \begin{bmatrix} 1 & 1 \\ 1 & 2 \\ 1 & 3 \end{bmatrix} \begin{bmatrix} C \\ D \end{bmatrix} = \begin{bmatrix} 1 \\ 2 \\ 2 \end{bmatrix} $$

这个的方程 Ax = b 是无解的，解决办法就是求其最优解，即方程 $\,A^TA \hat {x} = A^Tb\,$ 的解。

最小二乘法下节还会详述。